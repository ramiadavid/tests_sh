#!/bin/bash
for i in "$@"; do
  case $i in
  -r=* | --repository=*)
    USER_REPO="${i#*=}"
    shift
    ;;
  -v=* | --version=*)
    ODOO_VERSION="${i#*=}"
    shift
    ;;
  -s=* | --stage=*)
    ODOO_STAGE="${i#*=}"
    shift
    ;;
  -d=* | --dbname=*)
    PGDATABASE="${i#*=}"
    shift
    ;;
  -u=* | --user=*)
    PGUSER="${i#*=}"
    shift
    ;;
    -h=* | --host=*)
    PGHOST="${i#*=}"
    shift
    ;;
  -* | --*)
    echo "Unknown option $i"
    exit 1
    ;;
  *) ;;

  esac
done

printf "#/bin/bash\n
export USER_REPO=\"%s\"

", USER_REPO > /etc/profile/01-env-vars.sh

git clone git@github.com:odoo/odoo.git --depth=1 -b 16.0 /home/odoo/src/odoo
git clone git@github.com:odoo/design-themes.git --depth=1 -b 16.0 /home/odoo/src/themes
git clone git@github.com:odoo/enterprise.git --depth=1 -b 16.0 /home/odoo/src/enterprise
git clone "${USER_REPO}" --recurse-submodules --depth=1 -b main /home/odoo/src/user

update-libs

systemctl enable odoo
systemctl restart odoo
